[BotW_CalcRot_V208]
moduleMatches = 0x6267BFD0

.origin = codecave

squareRoot:
	stwu r1,-16(r1)
	stw r31,12(r1)
	mr r31,r1
	fdivs f12,f1,f1
	fadds f12,f1,f12
	lis r9,LC0@ha
	lfs f11,LC0@l(r9)
	fmuls f12,f12,f11
	fdivs f0,f1,f12
	fadds f12,f0,f12
	fmuls f12,f12,f11
	fdivs f0,f1,f12
	fadds f12,f0,f12
	fmuls f12,f12,f11
	fdivs f0,f1,f12
	fadds f12,f0,f12
	fmuls f12,f12,f11
	fdivs f0,f1,f12
	fadds f12,f0,f12
	fmuls f12,f12,f11
	fdivs f0,f1,f12
	fadds f12,f0,f12
	fmuls f0,f12,f11
	fdivs f1,f1,f0
	fadds f1,f1,f0
	fmuls f1,f1,f11
	addi r11,r31,16
	lwz r31,-4(r11)
	mr r1,r11
	blr
crossProduct:
	stwu r1,-16(r1)
	stw r31,12(r1)
	mr r31,r1
	lfs f8,4(r4)
	lfs f10,8(r5)
	lfs f7,4(r5)
	lfs f12,8(r4)
	fmuls f9,f8,f10
	fmuls f0,f7,f12
	fsubs f9,f9,f0
	stfs f9,0(r3)
	lfs f11,0(r5)
	lfs f0,0(r4)
	fmuls f12,f12,f11
	fmuls f10,f10,f0
	fsubs f12,f12,f10
	stfs f12,4(r3)
	fmuls f0,f7,f0
	fmuls f11,f8,f11
	fsubs f0,f0,f11
	stfs f0,8(r3)
	addi r11,r31,16
	lwz r31,-4(r11)
	mr r1,r11
	blr
multiplyVector:
	stwu r1,-16(r1)
	stw r31,12(r1)
	mr r31,r1
	lfs f0,0(r3)
	fmuls f0,f0,f1
	stfs f0,0(r3)
	lfs f0,4(r3)
	fmuls f0,f0,f1
	stfs f0,4(r3)
	lfs f0,8(r3)
	fmuls f1,f0,f1
	stfs f1,8(r3)
	addi r11,r31,16
	lwz r31,-4(r11)
	mr r1,r11
	blr
normalize:
	stwu r1,-40(r1)
	mflr r0
	stw r0,44(r1)
	stfd f29,16(r1)
	stfd f30,24(r1)
	stfd f31,32(r1)
	stw r30,8(r1)
	stw r31,12(r1)
	mr r31,r1
	mr r30,r3
	lfs f29,0(r3)
	lfs f30,4(r3)
	lfs f31,8(r3)
	fmuls f1,f29,f29
	fmuls f0,f30,f30
	fadds f0,f1,f0
	fmuls f1,f31,f31
	fadds f1,f0,f1
	bl squareRoot
	fdivs f29,f29,f1
	stfs f29,0(r30)
	fdivs f30,f30,f1
	stfs f30,4(r30)
	fdivs f31,f31,f1
	stfs f31,8(r30)
	addi r11,r31,40
	lwz r0,4(r11)
	mtlr r0
	lwz r30,-32(r11)
	lwz r31,-28(r11)
	lfd f29,-24(r11)
	lfd f30,-16(r11)
	lfd f31,-8(r11)
	mr r1,r11
	blr
calculateNewRotation:
	stwu r1,-264(r1)
	mflr r0
	stw r0,268(r1)
	stfd f21,176(r1)
	stfd f22,184(r1)
	stfd f23,192(r1)
	stfd f24,200(r1)
	stfd f25,208(r1)
	stfd f26,216(r1)
	stfd f27,224(r1)
	stfd f28,232(r1)
	stfd f29,240(r1)
	stfd f30,248(r1)
	stfd f31,256(r1)
	stw r28,160(r1)
	stw r29,164(r1)
	stw r30,168(r1)
	stw r31,172(r1)
	mr r31,r1
	lis r9,oldTargetX@ha
	lfs f0,oldTargetX@l(r9)
	lis r9,LC5@ha
	lfs f12,LC5@l(r9)
	fcmpu cr0,f0,f12
	BNE cr0, L10
	lis r9,oldTargetY@ha
	lfs f11,oldTargetY@l(r9)
	fcmpu cr0,f11,f12
	BNE cr0, L10
	lis r9,oldTargetZ@ha
	lfs f10,oldTargetZ@l(r9)
	fcmpu cr0,f10,f12
	BNE cr0, L10
	lis r9,oldPosX@ha
	lfs f12,oldPosX@l(r9)
	lis r9,newPosX@ha
	stfs f12,newPosX@l(r9)
	lis r9,oldPosY@ha
	lfs f12,oldPosY@l(r9)
	lis r9,newPosY@ha
	stfs f12,newPosY@l(r9)
	lis r9,oldPosZ@ha
	lfs f12,oldPosZ@l(r9)
	lis r9,newPosZ@ha
	stfs f12,newPosZ@l(r9)
	lis r9,newTargetX@ha
	stfs f0,newTargetX@l(r9)
	lis r9,newTargetY@ha
	stfs f11,newTargetY@l(r9)
	lis r9,newTargetZ@ha
	stfs f10,newTargetZ@l(r9)
	li r9,0
	lis r10,newRotX@ha
	stw r9,newRotX@l(r10)
	lis r10,LC2@ha
	lfs f0,LC2@l(r10)
	lis r10,newRotY@ha
	stfs f0,newRotY@l(r10)
	lis r10,newRotZ@ha
	stw r9,newRotZ@l(r10)
	b L9
	.align 4
L10:
	lis r9,oldPosX@ha
	lfs f12,oldPosX@l(r9)
	fsubs f0,f0,f12
	stfs f0,116(r31)
	lis r9,oldTargetY@ha
	lfs f0,oldTargetY@l(r9)
	lis r9,oldPosY@ha
	lfs f12,oldPosY@l(r9)
	fsubs f0,f0,f12
	stfs f0,120(r31)
	lis r9,oldTargetZ@ha
	lfs f0,oldTargetZ@l(r9)
	lis r9,oldPosZ@ha
	lfs f12,oldPosZ@l(r9)
	fsubs f0,f0,f12
	stfs f0,124(r31)
	addi r3,r31,116
	bl normalize
	lfs f0,116(r31)
	fneg f0,f0
	stfs f0,32(r31)
	lfs f0,120(r31)
	fneg f0,f0
	stfs f0,36(r31)
	lfs f0,124(r31)
	fneg f0,f0
	stfs f0,40(r31)
	li r9,0
	stw r9,104(r31)
	lis r10,LC2@ha
	lfs f0,LC2@l(r10)
	stfs f0,108(r31)
	stw r9,112(r31)
	addi r3,r31,92
	addi r4,r31,104
	addi r5,r31,32
	bl crossProduct
	lfs f1,92(r31)
	lfs f12,96(r31)
	lfs f0,100(r31)
	fmuls f1,f1,f1
	fmuls f12,f12,f12
	fadds f1,f1,f12
	fmuls f0,f0,f0
	fadds f1,f1,f0
	lis r9,LC1@ha
	lfs f0,LC1@l(r9)
	fcmpu cr0,f1,f0
	BGE cr0, L12
	fmr f1,f0
	.align 4
L12:
	bl squareRoot
	addi r3,r31,92
	lis r9,LC2@ha
	lfs f0,LC2@l(r9)
	fdivs f1,f0,f1
	bl multiplyVector
	lwz r8,0(r3)
	lwz r10,4(r3)
	lwz r9,8(r3)
	stw r8,8(r31)
	stw r10,12(r31)
	stw r9,16(r31)
	addi r3,r31,144
	addi r4,r31,32
	addi r5,r31,8
	bl crossProduct
	lwz r9,144(r31)
	stw r9,20(r31)
	lwz r9,148(r31)
	stw r9,24(r31)
	lwz r9,152(r31)
	stw r9,28(r31)
	lfs f0,8(r31)
	lfs f12,24(r31)
	lfs f11,40(r31)
	fsubs f8,f0,f12
	fsubs f8,f8,f11
	fsubs f9,f12,f0
	fsubs f9,f9,f11
	fsubs f10,f11,f0
	fsubs f10,f10,f12
	fadds f12,f0,f12
	fadds f0,f11,f12
	li r30,0
	fcmpu cr0,f8,f0
	BLE cr0, L13
	fmr f0,f8
	li r30,1
	b L13
	.align 4
L13:
	fcmpu cr0,f0,f9
	BLT cr0, L15
	fcmpu cr0,f0,f10
	BLT cr0, L16
	lis r9,LC2@ha
	lfs f1,LC2@l(r9)
	fadds f1,f0,f1
	bl squareRoot
	lis r9,LC0@ha
	lfs f27,LC0@l(r9)
	fmuls f1,f1,f27
	lis r9,LC3@ha
	lfs f11,LC3@l(r9)
	fdivs f11,f11,f1
	cmpwi cr0,r30,0
	BNE cr0, L17
	lfs f31,36(r31)
	lfs f0,28(r31)
	fsubs f31,f0,f31
	fmuls f31,f31,f11
	lfs f12,16(r31)
	lfs f0,32(r31)
	fsubs f12,f0,f12
	fmuls f12,f12,f11
	lfs f8,20(r31)
	lfs f0,12(r31)
	fsubs f0,f0,f8
	fmuls f8,f0,f11
	b L18
	.align 4
L17:
	cmpwi cr0,r30,1
	BNE cr0, L26
	lfs f9,36(r31)
	lfs f0,28(r31)
	fsubs f9,f0,f9
	lfs f0,20(r31)
	lfs f12,12(r31)
	fadds f12,f12,f0
	fmuls f12,f12,f11
	lfs f0,16(r31)
	lfs f8,32(r31)
	fadds f0,f8,f0
	fmuls f8,f0,f11
	fmr f31,f1
	fmuls f1,f9,f11
	b L18
	.align 4
L26:
	lis r9,LC5@ha
	lfs f8,LC5@l(r9)
	fmr f12,f8
	fmr f31,f8
	fmr f1,f8
	.align 4
L18:
	lis r9,hmdQuatW@ha
	lfs f27,hmdQuatW@l(r9)
	lis r9,hmdQuatZ@ha
	lfs f7,hmdQuatZ@l(r9)
	lis r9,hmdQuatY@ha
	lfs f10,hmdQuatY@l(r9)
	lis r9,hmdQuatX@ha
	lfs f11,hmdQuatX@l(r9)
	fmuls f22,f31,f27
	fmuls f9,f12,f7
	fadds f22,f22,f9
	fmuls f9,f8,f10
	fsubs f9,f22,f9
	fmuls f30,f1,f11
	fadds f22,f9,f30
	fneg f0,f31
	fmuls f30,f7,f0
	fmuls f9,f12,f27
	fadds f30,f30,f9
	fmuls f9,f8,f11
	fadds f9,f30,f9
	fmuls f30,f1,f10
	fadds f30,f9,f30
	fmuls f31,f31,f10
	fmuls f9,f12,f11
	fsubs f31,f31,f9
	fmuls f9,f8,f27
	fadds f31,f31,f9
	fmuls f9,f1,f7
	fadds f31,f31,f9
	fmuls f11,f11,f0
	fmuls f12,f12,f10
	fsubs f12,f11,f12
	fmuls f0,f8,f7
	fsubs f0,f12,f0
	fmuls f27,f1,f27
	fadds f27,f0,f27
	fmuls f23,f22,f22
	fmuls f24,f30,f31
	fmuls f26,f27,f22
	lis r28,oldPosX@ha
	lis r9,oldTargetX@ha
	lfs f12,oldTargetX@l(r9)
	lfs f0,oldPosX@l(r28)
	fsubs f12,f12,f0
	lis r29,oldPosY@ha
	lis r9,oldTargetY@ha
	lfs f0,oldTargetY@l(r9)
	lfs f1,oldPosY@l(r29)
	fsubs f0,f0,f1
	lis r30,oldPosZ@ha
	lis r9,oldTargetZ@ha
	lfs f1,oldTargetZ@l(r9)
	lfs f11,oldPosZ@l(r30)
	fsubs f1,f1,f11
	fmuls f12,f12,f12
	fmuls f0,f0,f0
	fadds f0,f12,f0
	fmuls f1,f1,f1
	fadds f1,f0,f1
	bl squareRoot
	fmuls f28,f22,f31
	fmuls f12,f27,f30
	fadds f28,f28,f12
	fadds f28,f28,f28
	fneg f28,f28
	fmuls f28,f28,f1
	fsubs f29,f24,f26
	fadds f29,f29,f29
	fneg f29,f29
	fmuls f29,f29,f1
	fmuls f0,f30,f30
	fadds f0,f23,f0
	fadds f0,f0,f0
	lis r9,LC2@ha
	lfs f25,LC2@l(r9)
	fsubs f0,f25,f0
	fneg f0,f0
	fmuls f21,f0,f1
	lis r9,hmdPosX@ha
	lfs f0,hmdPosX@l(r9)
	stfs f0,80(r31)
	lis r9,hmdPosY@ha
	lfs f0,hmdPosY@l(r9)
	stfs f0,84(r31)
	lis r9,hmdPosZ@ha
	lfs f0,hmdPosZ@l(r9)
	stfs f0,88(r31)
	stfs f22,68(r31)
	stfs f30,72(r31)
	stfs f31,76(r31)
	addi r3,r31,56
	addi r4,r31,68
	addi r5,r31,80
	bl crossProduct
	addi r3,r31,80
	fmr f1,f27
	bl multiplyVector
	lfs f12,4(r3)
	lfs f0,8(r3)
	lfs f11,0(r3)
	lfs f10,56(r31)
	fadds f11,f10,f11
	stfs f11,56(r31)
	lfs f11,60(r31)
	fadds f12,f11,f12
	stfs f12,60(r31)
	lfs f12,64(r31)
	fadds f0,f12,f0
	stfs f0,64(r31)
	addi r3,r31,44
	addi r4,r31,68
	addi r5,r31,56
	bl crossProduct
	addi r3,r31,44
	lis r9,LC4@ha
	lfs f1,LC4@l(r9)
	bl multiplyVector
	lfs f12,4(r3)
	lfs f0,84(r31)
	fadds f12,f12,f0
	lfs f11,8(r3)
	lfs f0,88(r31)
	fadds f9,f11,f0
	lfs f6,oldPosX@l(r28)
	lis r9,HeadPositionSensitivitySetting@ha
	lfs f11,HeadPositionSensitivitySetting@l(r9)
	lfs f10,0(r3)
	lfs f0,80(r31)
	fadds f10,f10,f0
	fmuls f10,f10,f11
	fadds f28,f28,f6
	fadds f28,f28,f10
	lis r9,newTargetX@ha
	stfs f28,newTargetX@l(r9)
	lfs f7,oldPosY@l(r29)
	fmuls f0,f12,f11
	lis r9,HeightPositionOffsetSetting@ha
	lfs f8,HeightPositionOffsetSetting@l(r9)
	fadds f29,f29,f7
	fadds f29,f29,f0
	fsubs f29,f29,f8
	lis r9,newTargetY@ha
	stfs f29,newTargetY@l(r9)
	lfs f12,oldPosZ@l(r30)
	fmuls f11,f9,f11
	fadds f21,f21,f12
	fadds f21,f21,f11
	lis r9,newTargetZ@ha
	stfs f21,newTargetZ@l(r9)
	fadds f10,f6,f10
	lis r9,newPosX@ha
	stfs f10,newPosX@l(r9)
	fadds f0,f7,f0
	fsubs f0,f0,f8
	lis r9,newPosY@ha
	stfs f0,newPosY@l(r9)
	fadds f11,f12,f11
	lis r9,newPosZ@ha
	stfs f11,newPosZ@l(r9)
	fmuls f30,f22,f30
	fmuls f27,f27,f31
	fsubs f30,f30,f27
	fadds f30,f30,f30
	lis r9,newRotX@ha
	stfs f30,newRotX@l(r9)
	fmuls f31,f31,f31
	fadds f31,f23,f31
	fadds f31,f31,f31
	fsubs f31,f25,f31
	lis r9,newRotY@ha
	stfs f31,newRotY@l(r9)
	fadds f26,f24,f26
	fadds f26,f26,f26
	lis r9,newRotZ@ha
	stfs f26,newRotZ@l(r9)
	b L9
	.align 4
L16:
	lis r9,LC2@ha
	lfs f1,LC2@l(r9)
	fadds f1,f10,f1
	bl squareRoot
	lis r9,LC0@ha
	lfs f27,LC0@l(r9)
	fmuls f1,f1,f27
	lis r9,LC3@ha
	lfs f11,LC3@l(r9)
	fdivs f11,f11,f1
	lfs f9,20(r31)
	lfs f0,12(r31)
	fsubs f9,f0,f9
	lfs f0,16(r31)
	lfs f31,32(r31)
	fadds f31,f31,f0
	fmuls f31,f31,f11
	lfs f0,36(r31)
	lfs f12,28(r31)
	fadds f12,f12,f0
	fmuls f12,f12,f11
	fmr f8,f1
	fmuls f1,f9,f11
	b L18
	.align 4
L29:
	lis r9,LC2@ha
	lfs f1,LC2@l(r9)
	fadds f1,f9,f1
	bl squareRoot
	lis r9,LC0@ha
	lfs f27,LC0@l(r9)
	fmuls f1,f1,f27
	lis r9,LC3@ha
	lfs f11,LC3@l(r9)
	fdivs f11,f11,f1
	lfs f10,16(r31)
	lfs f0,32(r31)
	fsubs f10,f0,f10
	lfs f0,20(r31)
	lfs f31,12(r31)
	fadds f31,f31,f0
	fmuls f31,f31,f11
	lfs f0,36(r31)
	lfs f8,28(r31)
	fadds f0,f8,f0
	fmuls f8,f0,f11
	fmr f12,f1
	fmuls f1,f10,f11
	b L18
	.align 4
L15:
	fcmpu cr0,f9,f10
	BLT cr0, L16
	b L29
	.align 4
L9:
	addi r11,r31,264
	lwz r0,4(r11)
	mtlr r0
	lwz r28,-104(r11)
	lwz r29,-100(r11)
	lwz r30,-96(r11)
	lwz r31,-92(r11)
	lfd f21,-88(r11)
	lfd f22,-80(r11)
	lfd f23,-72(r11)
	lfd f24,-64(r11)
	lfd f25,-56(r11)
	lfd f26,-48(r11)
	lfd f27,-40(r11)
	lfd f28,-32(r11)
	lfd f29,-24(r11)
	lfd f30,-16(r11)
	lfd f31,-8(r11)
	mr r1,r11
	blr
LC0:
	.int	1056964608
LC1:
	.int	841731191
LC2:
	.int	1065353216
LC3:
	.int	1048576000
LC4:
	.int	1073741824
LC5:
	.int	0